var DEFAULT_MAX=5,defaultNextTaskCheck=function(e,n){return Promise.resolve(e.amountStarted<n.length)},DEFAULT_OPTIONS={maxInProgress:DEFAULT_MAX,failFast:!1,nextCheck:defaultNextTaskCheck,ignoreIsFunctionCheck:!1};function raw(e,n){return new Promise(function(t,o){var a=Object.assign({},DEFAULT_OPTIONS,n),c={amountDone:0,amountStarted:0,amountResolved:0,amountRejected:0,amountNextCheckFalsey:0,rejectedIndexes:[],resolvedIndexes:[],nextCheckFalseyIndexes:[],taskResults:[]};if(0===e.length)return t(c);for(var s=!1,u=0,f=function(){if(!0!==s){if(c.amountDone++,"function"==typeof a.progressCallback&&a.progressCallback(c),c.amountDone===e.length)return t(c);u<e.length&&r(u++)}},r=function(n){a.nextCheck(c,e).then(function(t){!0===t?function(n){if(c.amountStarted++,"function"==typeof e[n])e[n]().then(function(e){c.taskResults[n]=e,c.resolvedIndexes.push(n),c.amountResolved++,f()},function(e){if(c.taskResults[n]=e,c.rejectedIndexes.push(n),c.amountRejected++,!0===a.failFast)return s=!0,o(c);f()});else{if(!0!==a.ignoreIsFunctionCheck)return s=!0,o(new Error("tasks["+n+"]: "+e[n]+", is supposed to be of type function"));c.taskResults[n]=e[n],c.resolvedIndexes.push(n),c.amountResolved++,f()}}(n):(c.amountNextCheckFalsey++,c.nextCheckFalseyIndexes.push(n),f())},o)},i=0;i<Math.min(a.maxInProgress,e.length);i++)r(u++)})}function executeRaw(e,n){return new Promise(function(t,o){raw(e,n).then(function(e){t(e.taskResults)},function(e){e instanceof Error?o(e):o(e.taskResults[e.rejectedIndexes[0]])})})}function sync(e,n){return executeRaw(e,Object.assign({},{maxInProgress:1,failFast:!0},n))}function all(e,n){return executeRaw(e,Object.assign({},{failFast:!0},n))}export{raw,sync,all};
//# sourceMappingURL=throttle.mjs.map
